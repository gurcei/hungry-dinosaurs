#OUTPUT "HUNGRYDINOSAURS"'------------------------.DECLARES'--------#DECLARE K, Z, NORTH%, SOUTH%, EAST%, WEST%, ALLOW%, RES%#DECLARE A$,B$,C$,TOK$#DECLARE CURRENTØROOM%, PREVIOUSØROOM%#DECLARE INVENTORY$(10),INVØCOUNT%=0,INVØIDX%=0#DECLARE FEDØDINOØCOUNT% = 0#DECLARE CURX%,CURY%, S$, CR, DC, DK, DL, OFFSET%, LINE$, A, VALID%, SK#DECLARE LOADØSTATE%#DECLARE RET%, FILLØSTATE%#DEFINE √œÃœ’“ = 63#DECLARE VECØDATA%(12000)#DECLARE VECØSIZE% = 3#DECLARE SELECTEDØCOLOUR% = 1#DECLARE LASTØCOLOUR% = -1#DEFINE Ã…Œ≈    = 0#DEFINE √…“√Ã≈  = 1#DEFINE ≈ÃÃ…–”≈ = 2#DEFINE ¬œÿ     = 3#DEFINE –œÃŸ    = 4#DECLARE M0%, M1%, LX0%, LY0%, MX%, MY%, CX0%, CY0%, EX0%, EY0%#DECLARE RADIUS%, XRADIUS%, YRADIUS%, BX0%, BY0%, POLYØIDX%#DECLARE POLYØX%(250), POLYØY%(250), YMIN%, YMAX%#DECLARE IDX%, REV%, Y0%, Y1%, TMP%, Y%#DECLARE X0%, X1%, X%, Y%, M, C, PIDX%, PX%(20), I%, SWAPPED%, J%#DECLARE PRESENT$(4), MISSING% = 0, GAMEØOVER% = 0PRESENT$(0) = "WHISTLE"PRESENT$(1) = "FLOPPY-DISK"PRESENT$(2) = "MEGA65"PRESENT$(3) = "PROGRAM-LISTING"#DECLARE MAPØLOCØTOØOBJS$(4,2)#DECLARE MAPØIDX%#DEFINE «≈“Õ¡ŒŸ=0#DEFINE ‘’“À≈Ÿ=1#DEFINE ‘»¡…Ã¡Œƒ=2#DEFINE ÷…≈‘Œ¡Õ=3#DEFINE ¡’”‘“¡Ã…¡=4#DEFINE Õ¡ÿØ“œœÕ”=5#STRUCT “œœÕ DESC$, EXITS$, LOCS$, VART$, OFFSET%“œœÕ ROOMS(Õ¡ÿØ“œœÕ”) = [ _ [ "ŸOU ARE TRAPPED IN œNION √AKE'S DIRTY SMELLY PRISON!", _     "", "", "GERMAN.V", 0 ], _ [ "¡ ‘URKISH DINOSAUR IS BATHING IN THE THERMAL WATERS.", _     "”", "2", "TURK.V", 0 ], _ [ "¡ ‘HAI DINOSUAR IS PERFORMING A TRADITIONAL DANCE.", _     "Œ≈", "13", "THAI.V", -9 ], _  [ "¡ ÷IETNAMESE DINOSAUR IS TENDING TO THE RICE TERRACES.", _     "◊”", "24", "VIET.V", 0 ], _ [ "¡N INEBRIATED ¡USTRALIAN DINOSAUR RESTS PEACEFULLY.", _     "Œ", "3", "AUS.V", -16 ] _]#DECLARE HASØATTICØRAM%=0#DECLARE CACHED%(Õ¡ÿØ“œœÕ”),OFFS#DECLARE PROG$(7), FINISHEDØLINES%=0PROG$(0)="10 PRINT "+CHR$(34)+"I PROMISE TO ONION CAKE THAT I WILL"+CHR$(34)PROG$(1)="20 PRINT "+CHR$(34)+"- ALWAYS WRITE BEAUTIFUL MEGA65 PROGRAMS"+CHR$(34)PROG$(2)="30 PRINT "+CHR$(34)+"- MAKE USE OF DELICIOUS PETSCII CHARACTERS"+CHR$(34)PROG$(3)="40 PRINT "+CHR$(34)+"- MAKE BEAUTIFUL SID MUSIC WITH THE 'PLAY' COMMAND"+CHR$(34)BORDER 0:BACKGROUND 0:PRINT CHR$(14);CHR$(30);GOSUB ATTICØRAMØCHECKGOTO MAIN.ATTICØRAMØCHECK'---------------  PRINT CHR$(147);  POKE $8000000, 35  IF PEEK($8000000) <> 35 THEN BEGIN    HASØATTICØRAM% = 0    PRINT "ŒO ATTIC RAM DETECTED (WILL NOT CACHE ART)"    SLEEP 1    PRINT CHR$(147);    RETURN  BEND  POKE $8000000, 36  IF PEEK($8000000) <> 36 THEN BEGIN    HASØATTICØRAM% = 0    PRINT "ŒO ATTIC RAM DETECTED (WILL NOT CACHE ART)"    SLEEP 1    PRINT CHR$(147);    RETURN  BEND    HASØATTICØRAM%=1  PRINT "¡TTIC RAM DETECTED (WILL CACHE ART)"  SLEEP 1  RETURN.REMOVEØFROMØLOC'---------------  IF MAPØIDX%=1 THEN BEGIN    MAPØLOCØTOØOBJS$(CURRENTØROOM%,1) = ""  BEND:ELSE IF MAPØIDX%=0 THEN BEGIN    MAPØLOCØTOØOBJS$(CURRENTØROOM%,0) = ""    IF MAPØLOCØTOØOBJS$(CURRENTØROOM%,1) <> "" THEN BEGIN      MAPØLOCØTOØOBJS$(CURRENTØROOM%,0) = MAPØLOCØTOØOBJS$(CURRENTØROOM%,1)      MAPØLOCØTOØOBJS$(CURRENTØROOM%,1) = ""    BEND  BEND  RETURN.TAKE'----  GOSUB EXTRACTØTOKEN  MAPØIDX% = -1  B$=""  FOR K = 0 TO 1    C$ = MAPØLOCØTOØOBJS$(CURRENTØROOM%,K)    IF TOK$ = LEFT$(C$,3) THEN B$ = C$:MAPØIDX% = K  NEXT K  IF LEFT$(B$,3) = TOK$ THEN BEGIN    ALLOW% = 1    IF TOK$="EGG" THEN BEGIN      S$="‘HE EGGPLANT STUBBORNLY RESISTS YOUR ATTEMPT TO TAKE IT!"      CR=1:DC=14:GOSUB DRAWØTEXT      ALLOW%=0    BEND    IF B$="RICE-PLANT" THEN BEGIN      S$="‘HE RICE-PLANT REFUSES TO RELENT TO YOUR WILL!"      CR=1:DC=14:GOSUB DRAWØTEXT      ALLOW%=0    BEND    IF TOK$="CAR" THEN BEGIN      S$="‘HE CARNIVOROUS-MITE GNASHES ITS TEETH AT YOU, FORCING YOU TO BACK DOWN!"      CR=1:DC=14:GOSUB DRAWØTEXT      ALLOW%=0    BEND    IF TOK$="TIG" THEN BEGIN      S$="‘HE TIGER UNLEASHES A FEROCIOUS GROWL, MAKING YOU SHIVER IN YOUR BOOTS!"      CR=1:DC=14:GOSUB DRAWØTEXT      ALLOW%=0    BEND    IF ALLOW%=1 THEN BEGIN      INVENTORY$(INVØCOUNT%) = B$      INVØCOUNT% = INVØCOUNT% + 1      GOSUB REMOVEØFROMØLOC      S$="ŸOU TAKE THE ":CR=0:DC=14:GOSUB DRAWØTEXT      S$=B$:CR=0:DC=3:GOSUB DRAWØTEXT      S$="...":CR=1:DC=14:GOSUB DRAWØTEXT    BEND  BEND:ELSE BEGIN    S$="ŸOU CAN'T SEE THAT HERE!"    CR=1:DC=14:GOSUB DRAWØTEXT  BEND  RETURN.HIT'---  GOSUB EXTRACTØTOKEN  MAPØIDX% = -1  B$=""  FOR K = 0 TO 1    C$ = MAPØLOCØTOØOBJS$(CURRENTØROOM%,K)    IF TOK$ = LEFT$(C$,3) THEN B$ = C$:MAPØIDX% = K  NEXT K  IF LEFT$(B$,3) = TOK$ THEN BEGIN    IF TOK$="EGG" THEN BEGIN      S$="‘HE IMPACT OF YOUR FIST CAUSES IT TO BECOME A "      CR=0:DC=14:GOSUB DRAWØTEXT      S$="FAINTED-EGGPLANT":CR=0:DC=3:GOSUB DRAWØTEXT      S$=".":CR=1:GOSUB DRAWØTEXT      MAPØLOCØTOØOBJS$(CURRENTØROOM%,MAPØIDX%)="FAINTED-EGGPLANT"    BEND    IF TOK$="RIC" THEN BEGIN      S$="ŸOU FLATTEN THE RICE WITH YOUR FIST, FORMING A TASTY "      CR=0:DC=14:GOSUB DRAWØTEXT      S$="RICE-PAPER-ROLL":CR=0:DC=3:GOSUB DRAWØTEXT      S$=".":CR=1:DC=14:GOSUB DRAWØTEXT      MAPØLOCØTOØOBJS$(CURRENTØROOM%,MAPØIDX%)="RICE-PAPER-ROLL"    BEND    IF TOK$="CAR" THEN BEGIN      S$="ŸOUR VIOLENT ACTIONS HAVE MADE THE MITE RETHINK LIFE, IT IS NOW A "      CR=0:DC=14:GOSUB DRAWØTEXT      S$="VEGAN-MITE":CR=0:DC=3:GOSUB DRAWØTEXT      S$=".":CR=1:DC=14:GOSUB DRAWØTEXT      MAPØLOCØTOØOBJS$(CURRENTØROOM%,MAPØIDX%)="VEGAN-MITE"    BEND    IF TOK$="TIG" THEN BEGIN      S$="… THINK YOU HURT ITS FEELINGS, IT IS NOW A "      CR=0:DC=14:GOSUB DRAWØTEXT      S$="CRYING-TIGER":CR=0:DC=3:GOSUB DRAWØTEXT      S$="...":CR=1:DC=14:GOSUB DRAWØTEXT      MAPØLOCØTOØOBJS$(CURRENTØROOM%,MAPØIDX%)="CRYING-TIGER"    BEND  BEND:ELSE BEGIN    S$="ŸOU CAN'T SEE THAT HERE!"    CR=1:DC=14:GOSUB DRAWØTEXT  BEND  RETURN.FINDØINØINVENTORY'-----------------  RES% = 0 : INVØIDX% = -1  IF INVØCOUNT%=0 THEN RETURN  FOR K=0 TO INVØCOUNT%-1    IF LEFT$(INVENTORY$(K),3) = TOK$ THEN RES% = 1:INVØIDX% = K:B$=INVENTORY$(K)  NEXT K  RETURN.REMOVEØFROMØINVENTORY'---------------------  IF INVØIDX%=INVØCOUNT%-1 THEN INVØCOUNT%=INVØCOUNT%-1:RETURN  FOR K=INVØIDX%+1 TO INVØCOUNT%-1    INVENTORY$(K-1) = INVENTORY$(K)  NEXT K  INVØCOUNT% = INVØCOUNT% - 1  RETURN.DROPØPRESENT'-----------  IF MAPØLOCØTOØOBJS$(CURRENTØROOM%,0) = "" THEN BEGIN    MAPØLOCØTOØOBJS$(CURRENTØROOM%,0) = PRESENT$(FEDØDINOØCOUNT%)  BEND:ELSE BEGIN    MAPØLOCØTOØOBJS$(CURRENTØROOM%,1) = PRESENT$(FEDØDINOØCOUNT%)  BEND  RETURN.GIVE'----  GOSUB EXTRACTØTOKEN  GOSUB FINDØINØINVENTORY  IF RES%=0 THEN BEGIN    S$="ŸOU ARE NOT CARRYING THAT!"    CR=1:DC=14:GOSUB DRAWØTEXT    RETURN  BEND  IF LEFT$(B$,3) = TOK$ THEN BEGIN    ALLOW%=0    IF TOK$="RIC" AND CURRENTØROOM%=÷…≈‘Œ¡Õ THEN ALLOW%=1    IF TOK$="VEG" AND CURRENTØROOM%=¡’”‘“¡Ã…¡ THEN ALLOW%=1    IF TOK$="CRY" AND CURRENTØROOM%=‘»¡…Ã¡Œƒ THEN ALLOW%=1    IF TOK$="FAI" AND CURRENTØROOM%=‘’“À≈Ÿ THEN ALLOW%=1    IF CURRENTØROOM%=«≈“Õ¡ŒŸ THEN BEGIN      IF TOK$="MEG" THEN BEGIN        S$="'ŒOT YET, SHOW ME THAT YOU KNOW HOW TO USE THIS BEAUTIFUL MACHINE, OR ELSE...'"        CR=1:DC=2:GOSUB DRAWØTEXT      BEND:ELSE BEGIN        S$="œNION √AKE GLARES AT YOU, "        CR=0:DC=14:GOSUB DRAWØTEXT        S$="'”TOP WASTING TIME AND PROVE YOUR SKILLS TO ME!'"        CR=1:DC=2:GOSUB DRAWØTEXT      BEND      RETURN    BEND    IF ALLOW% = 0 THEN BEGIN      S$="‘HE DINOSAUR APPRECIATES YOUR KIND GESTURE, BUT THAT ISN'T THE FOOD IT LIKES"      CR=1:DC=14:GOSUB DRAWØTEXT    BEND    IF ALLOW% = 1 THEN BEGIN      GOSUB REMOVEØFROMØINVENTORY      IF CURRENTØROOM% = ÷…≈‘Œ¡Õ THEN BEGIN        S$="‘HE ÷IETNAMESE DINOSAUR DEVOURS THE TASTY RICE-PAPER ROLL..."        CR=1:DC=14:GOSUB DRAWØTEXT      BEND      IF CURRENTØROOM% = ¡’”‘“¡Ã…¡ THEN BEGIN        S$="‘HE ¡USTRALIAN DINOSAUR CHOMPS DOWN THE SCRUMPTIOUS MITE AND THEN"        CR=1:DC=14:GOSUB DRAWØTEXT        S$="FALLS BACK ASLEEP..."        CR=1:DC=14:GOSUB DRAWØTEXT      BEND      IF CURRENTØROOM% = ‘»¡…Ã¡Œƒ THEN BEGIN        S$="‘HE ‘HAI DINOSAUR GRACEFULLY DINES ON THE CRYING-TIGER, AND "        CR=1:DC=14:GOSUB DRAWØTEXT        S$="THEN RAISES ITS CLASPED PAWS TO ITS FOREHEAD TO WAI IN THANKS."        CR=1:DC=14:GOSUB DRAWØTEXT      BEND      IF CURRENTØROOM% = ‘’“À≈Ÿ THEN BEGIN        S$="‘HE ‘URKISH DINOSAUR ENTHUSIASTICALLY RIPS INTO THE TASTY FAINTED-EGGPLANT!"        CR=1:DC=14:GOSUB DRAWØTEXT      BEND      S$="…T DROPS A PRESENT FOR YOU TO SHOW ITS GRATITUDE..."      CR=1:DC=14:GOSUB DRAWØTEXT            GOSUB DROPØPRESENT      FEDØDINOØCOUNT% = FEDØDINOØCOUNT% + 1    BEND  BEND  RETURN.CHECKØWEØHAVEØALLØCOMPUTERØITEMS'--------------------------------  S$="œNION CAKE LOOKS OVER YOUR INVENTORY..."  CR=1:DC=14:GOSUB DRAWØTEXT  SLEEP 1  MISSING%=0  FOR Z = 0 TO 3    TOK$ = LEFT$(PRESENT$(Z), 3)    GOSUB FINDØINØINVENTORY    IF RES%=0 THEN BEGIN      S$="'»MM... ŸOU SEEM TO BE MISSING A "      CR=0:DC=2:GOSUB DRAWØTEXT      S$=PRESENT$(Z)      CR=0:DC=3:GOSUB DRAWØTEXT      S$="...'"      CR=1:DC=2:GOSUB DRAWØTEXT      MISSING%=1      SLEEP 1    BEND  NEXT Z  IF MISSING%=1 THEN BEGIN    RES%=0    S$="":CR=1:GOSUB DRAWØTEXT    S$="'… AM AFRAID THIS MEANS THAT … NEED TO SHOOT YOU NOW!'"    CR=1:DC=2:GOSUB DRAWØTEXT    SLEEP 1.5    S$="":CR=1:GOSUB DRAWØTEXT    S$="¬¡Œ«!"    CR=1:DC=10:GOSUB DRAWØTEXT    SLEEP 1.5    RETURN  BEND  S$="'ÃOOKS LIKE YOU'VE GOT IT ALL...'"  CR=1:DC=2:GOSUB DRAWØTEXT  SLEEP 1  S$="'ŒOW, DEMONSTRATE YOUR Õ≈«¡65 CODING SKILLS TO ME, OTHERWISE...'"  CR=1:DC=2:GOSUB DRAWØTEXT  SLEEP 2  RES% = 1  RETURN.CAPTUREDØBYØONIONØCAKE'----------------------  S$="’PON HEARING YOUR MELODIOUS WHISTLING, œNION √AKE ARRIVES, HOLDING YOU"  CR=1:DC=14:GOSUB DRAWØTEXT  S$="AT GUNPOINT, AND FORCEFULLY ESCORTING YOU TO HIS DUNGEON IN «ERMANY..."  CR=1:DC=14:GOSUB DRAWØTEXT  CURRENTØROOM% = «≈“Õ¡ŒŸ  SLEEP 2  SCREEN CLR 0  S$="'… FINALLY CAUGHT THE THIEF THAT STOLE MY Õ≈«¡65!'"  CR=0:DC=2:GOSUB DRAWØTEXT  S$=", œNION √AKE EXCLAIMS!"  CR=1:DC=14:GOSUB DRAWØTEXT  S$="":CR=1:GOSUB DRAWØTEXT  SLEEP 1  S$="'…F YOU SHOW ME YOUR PROGRAMMING SKILLS … WILL RELEASE YOU!'"  CR=0:DC=2:GOSUB DRAWØTEXT  S$=" HE OFFERS."  CR=1:DC=14:GOSUB DRAWØTEXT  S$="":CR=1:GOSUB DRAWØTEXT  SLEEP 1.5  S$="'…F NOT, … WILL SHOOT YOU!'"  CR=1:DC=2:GOSUB DRAWØTEXT  SLEEP 2  GOSUB CHECKØWEØHAVEØALLØCOMPUTERØITEMS  IF RES%=0 THEN GAMEØOVER%=1:RETURN  RETURN.TYPEØLINE'---------  GOSUB GETØINPUTØTOØA$  RETURN.ASSESSØLINE'-----------  IF A$=PROG$(FINISHEDØLINES%) THEN BEGIN    FINISHEDØLINES% = FINISHEDØLINES% + 1    IF FINISHEDØLINES%=4 THEN BEGIN      S$="'◊ELL DONE, YOU COMPLETED THE PROGRAM!'"      CR=1:DC=2:GOSUB DRAWØTEXT    BEND:ELSE BEGIN      S$="'«OOD, NOW FOR THE NEXT LINE!'"      CR=1:DC=2:GOSUB DRAWØTEXT    BEND  BEND:ELSE BEGIN    S$="'ŒO NO! ŸOU MADE MISTAKES ON THIS LINE!'"    CR=0:DC=2:GOSUB DRAWØTEXT    S$=", œNION √AKE ROARS"    CR=1:DC=14:GOSUB DRAWØTEXT    S$="'‘YPE IT AGAIN PROPERLY, OTHERWISE … WILL SHOOT YOU!'"    CR=1:DC=2:GOSUB DRAWØTEXT    S$=PROG$(FINISHEDØLINES%)    CR=1:DC=12:GOSUB DRAWØTEXT  BEND  RETURN.STARTØMEGA65'------------' DRAW MEGA65+LISTING  DO WHILE FINISHEDØLINES% < 4    GOSUB TYPEØLINE    GOSUB ASSESSØLINE  LOOP  S$="'…MPRESSIVE!'"  CR=0:DC=2:GOSUB DRAWØTEXT  S$=", œNION √AKE SAYS WITH ADMIRATION!"  CR=1:DC=14:GOSUB DRAWØTEXT  SLEEP 1  S$="'ŸOU HAVE PROVEN YOURSELF WORTHY TO KEEP ALIVE! … HEREBY RELEASE YOU!"  CR=1:DC=2:GOSUB DRAWØTEXT  SLEEP 1.5  S$="“EMEMBER YOUR PROMISE, OTHERWISE … WILL FIND YOU AND SHOOT YOU!'"  CR=1:DC=2:GOSUB DRAWØTEXT  SLEEP 1.5  S$="ŸOU ARE FREE AGAIN! √ONGRATULATIONS, YOU WON THE GAME!"  CR=1:DC=7:GOSUB DRAWØTEXT  GAMEØOVER%=1  SLEEP 1.5  RETURN.USE'---  GOSUB EXTRACTØTOKEN  GOSUB FINDØINØINVENTORY  IF RES%=0 THEN BEGIN    S$="ŸOU ARE NOT CARRYING THAT!"    CR=1:DC=14:GOSUB DRAWØTEXT    RETURN  BEND  IF LEFT$(B$,3) = TOK$ THEN BEGIN    IF TOK$="WHI" THEN GOSUB CAPTUREDØBYØONIONØCAKE:RETURN    IF TOK$="MEG" THEN BEGIN      IF CURRENTØROOM%=«≈“Õ¡ŒŸ THEN BEGIN        GOSUB STARTØMEGA65        GAMEØOVER%=1        RETURN      BEND:ELSE BEGIN        S$="»OW COULD YOU THINK OF PLAYING WITH YOUR Õ≈«¡65 WHEN THERE ARE HUNGRY"        CR=1:DC=14:GOSUB DRAWØTEXT        S$="DINOSAURS TO FEED?!"        CR=1:DC=14:GOSUB DRAWØTEXT        RETURN      BEND    BEND    S$="ŸOU CANNOT USE THAT!"    CR=1:DC=14:GOSUB DRAWØTEXT  BEND  RETURN.INVENTORY'---------  S$="ŸOU ARE CARRYING:"  CR=1:DC=14:GOSUB DRAWØTEXT  IF INVØCOUNT% = 0 THEN BEGIN    S$="  - NOTHING..."    CR=1:DC=12:GOSUB DRAWØTEXT  BEND:ELSE BEGIN    FOR K=0 TO INVØCOUNT%-1      S$="  - "      CR=0:DC=14:GOSUB DRAWØTEXT      S$=INVENTORY$(K)      CR=1:DC=3:GOSUB DRAWØTEXT    NEXT K  BEND  RETURN.EXTRACTØTOKEN'-------------  K = INSTR(A$," ")  TOK$=LEFT$(A$,3)  IF K>0 THEN BEGIN    A$=MID$(A$,K+1)  BEND:ELSE BEGIN    A$=""  BEND  RETURN.DRAWØCURSOR'-----------  PEN 0,1  DC=1  FOR DL=0 TO 15    LINE CURX%*8,320+CURY%*16+DL,CURX%*8+7,320+CURY%*16+DL  NEXT DL  RETURN.HIDEØCURSOR'-----------  PEN 0,0  FOR DL=0 TO 15    LINE CURX%*8,320+CURY%*16+DL,CURX%*8+7,320+CURY%*16+DL  NEXT DL  RETURN.SAFEØCURYØINC'-------------  CURY%=CURY% + 1  IF CURY% => 5 THEN BEGIN    GOSUB SCROLLØTEXTØUP    SLEEP .1  BEND  RETURN.GETØINPUTØTOØA$'---------------  GOSUB DRAWØCURSOR  LINE$=""  DO    GET KEY A$    A=ASC(A$)    VALID%=1    IF (A<32 OR A>127) AND A<>13 AND NOT (A=20 AND LEN(LINE$)>0) THEN VALID%=0    IF VALID% = 1 THEN BEGIN      IF A=13 THEN BEGIN ' CARRIAGE-RETURN?        A$=LINE$        GOSUB HIDEØCURSOR        CURX%=0        GOSUB SAFEØCURYØINC        RETURN      BEND      IF A=20 THEN BEGIN ' INST-DEL        LINE$=LEFT$(LINE$,LEN(LINE$)-1)        GOSUB HIDEØCURSOR        CURX%=CURX%-1        GOSUB DRAWØCURSOR      BEND      IF A<>13 AND A<>20 THEN BEGIN ' ANY OTHER KEY?        LINE$=LINE$+A$        GOSUB HIDEØCURSOR        S$=A$:CR=0:GOSUB DRAWØTEXT        GOSUB DRAWØCURSOR      BEND    BEND  LOOP  RETURN.USERØINPUT'----------  GOSUB GETØINPUTØTOØA$  IF A$="N" AND NORTH%<>-1 THEN CURRENTØROOM%=NORTH%  IF A$="S" AND SOUTH%<>-1 THEN CURRENTØROOM%=SOUTH%  IF A$="E" AND EAST%<>-1 THEN CURRENTØROOM%=EAST%  IF A$="W" AND WEST%<>-1 THEN CURRENTØROOM%=WEST%  IF A$="I" THEN GOSUB INVENTORY  IF A$="L" THEN GOSUB SHOWØROOMØTEXT  IF A$="X" THEN STOP  GOSUB EXTRACTØTOKEN  IF TOK$="LOO" THEN GOSUB SHOWØROOMØTEXT  IF TOK$="TAK" OR TOK$="GET" THEN GOSUB TAKE  IF TOK$="INV" THEN GOSUB INVENTORY  IF TOK$="HIT" THEN GOSUB HIT  IF TOK$="GIV" THEN GOSUB GIVE  IF TOK$="USE" THEN GOSUB USE  RETURN.SHOWØOBJECTS'------------  RES%=0  FOR K=0 TO 1    A$ = MAPØLOCØTOØOBJS$(CURRENTØROOM%, K)    B$ = LEFT$(A$,1)    C$ = "AEIOU"    IF A$<>"" THEN BEGIN      IF RES%=0 THEN BEGIN        S$="ŸOU SEE A" : CR=0 : DC=14 : GOSUB DRAWØTEXT        RES%=1      BEND : ELSE BEGIN        S$=" AND A" : CR=0 : DC=14 : GOSUB DRAWØTEXT      BEND      IF INSTR(C$,B$)<>0 THEN BEGIN        S$="N" : CR=0 : DC=14 : GOSUB DRAWØTEXT      BEND      S$ = " " + A$ : CR=0 : DC= 3 : GOSUB DRAWØTEXT    BEND  NEXT K    IF RES%<>0 THEN BEGIN    S$=" HERE.":CR=1:DC=14:GOSUB DRAWØTEXT  BEND  RETURN.SCROLLØTEXTØUP'--------------  FOR SK=0 TO 7    EDMA 0, 640*4, $40000+640*21+SK*$4000, $40000+640*20+SK*$4000  NEXT SK  FOR SK=0 TO 7    EDMA 3, 640, 0, $40000+640*24+SK*$4000  NEXT SK  CURY%=CURY%-1  RETURN.DRAWØTEXT'---------  PEN 0,DC  IF LEN(S$) > 0 THEN BEGIN    FOR DK = 0 TO LEN(S$)-1      CHAR CURX%, 320+CURY%*16,2,1,2,MID$(S$,DK+1,1)      CURX% = CURX% + 1      IF CURX% = 80 THEN BEGIN        CURX% = 0        GOSUB SAFEØCURYØINC      BEND    NEXT DK  BEND  IF CR=1 THEN BEGIN    CURX% = 0    GOSUB SAFEØCURYØINC  BEND  RETURN.SHOWØROOMØTEXT'--------------  S$=ROOMSØDESC$(CURRENTØROOM%):CR=1:DC=14:GOSUB DRAWØTEXT  GOSUB SHOWØOBJECTS  NORTH%=-1:SOUTH%=-1:EAST%=-1:WEST%=-1  S$="≈XITS: ":CR=0:DC=14:GOSUB DRAWØTEXT  A$ = ROOMSØEXITS$(CURRENTØROOM%)  IF LEN(A$) > 0 THEN BEGIN    FOR K=1 TO LEN(A$)      B$=MID$(A$,K,1)      C$=MID$(ROOMSØLOCS$(CURRENTØROOM%),K,1)      S$=B$:CR=0:DC=7:GOSUB DRAWØTEXT      IF K<>LEN(A$) THEN S$= ", ":CR=0:DC=14:GOSUB DRAWØTEXT      IF B$="Œ" THEN NORTH%=VAL(C$)      IF B$="”" THEN SOUTH%=VAL(C$)      IF B$="≈" THEN EAST%=VAL(C$)      IF B$="◊" THEN WEST%=VAL(C$)    NEXT K  BEND  IF LEN(A$)=0 THEN S$="NONE...":CR=0:DC=12:GOSUB DRAWØTEXT  S$="":CR=1:GOSUB DRAWØTEXT  RETURN.SHOWØROOMØGRAPHIC'-----------------  CURX% = 0  CURY% = 0  SCREEN CLR 0  IF HASØATTICØRAM%=1 AND CACHED%(CURRENTØROOM%)=1 THEN BEGIN    GOSUB LOADØFROMØCACHE    RETURN  BEND  OFFSET% = ROOMSØOFFSET%(CURRENTØROOM%)  GOSUB LOAD  RETURN.MAINØGAME'---------  GOSUB SHOWØROOMØGRAPHIC  GOSUB SHOWØROOMØTEXT.NEXTØINPUT  GOSUB USERØINPUT  IF GAMEØOVER%=1 THEN BEGIN    S$="":CR=1:DC=14:GOSUB DRAWØTEXT    S$="«¡Õ≈ œ÷≈“"    CR=1:DC=5:GOSUB DRAWØTEXT    SLEEP 2    SCREEN CLOSE    RETURN  BEND  IF CURRENTØROOM%<>PREVIOUSØROOM% THEN PREVIOUSØROOM%=CURRENTØROOM%:GOTO MAINØGAME  GOTO NEXTØINPUT  RETURN.INITØGAME'---------  PRINT CHR$(147);  CURRENTØROOM% = ÷…≈‘Œ¡Õ  PREVIOUSØROOM% = CURRENTØROOM%  INVØCOUNT% = 0  FEDØDINOØCOUNT% = 0  MISSING% = 0  GAMEØOVER% = 0  FINISHEDØLINES% = 0  MAPØLOCØTOØOBJS$(‘’“À≈Ÿ,0) = "RICE-PLANT"  MAPØLOCØTOØOBJS$(‘»¡…Ã¡Œƒ,0) = "CARNIVOROUS-MITE"  MAPØLOCØTOØOBJS$(÷…≈‘Œ¡Õ,0) = "EGGPLANT"  MAPØLOCØTOØOBJS$(¡’”‘“¡Ã…¡,0) = "TIGER"  MAPØLOCØTOØOBJS$(‘’“À≈Ÿ,1) = ""  MAPØLOCØTOØOBJS$(‘»¡…Ã¡Œƒ,1) = ""  MAPØLOCØTOØOBJS$(÷…≈‘Œ¡Õ,1) = ""  MAPØLOCØTOØOBJS$(¡’”‘“¡Ã…¡,1) = ""  SCREEN 0, 640, 400, 4  RETURN.MAIN'----  GOSUB SHOWØTITLEØPAGE  GOSUB INITØGAME  GOSUB MAINØGAME  GOTO MAIN  END.PRESSØAØKEY'-----------  PRINT  PRINT "[–RESS ANY KEY TO CONTINUE]"  GET KEY A$  RETURN.SHOWØTITLEØPAGE'---------------  PRINT CHR$(147);  PRINT "œNION √AKE AND THE »UNGRY ƒINOSAURS"  PRINT "==================================="  PRINT "  √ODING & ÕUSIC SEQUENCING BY «URCE …SIKYILDIZ"  PRINT "  ƒINO ¡RTISTRY BY ¡YCA …SIKYILDIZ"  PRINT  PRINT " …)NSTRUCTIONS"  PRINT " √)REDITS"  PRINT  PRINT " –RESS ”–¡√≈ ¬¡“ TO BEGIN"  GET A$  GET KEY A$  IF A$="I" THEN GOSUB INSTRUCTIONS:GOTO SHOWØTITLEØPAGE  IF A$="C" THEN GOSUB CREDITS:GOTO SHOWØTITLEØPAGE  IF A$<>" " THEN GOTO SHOWØTITLEØPAGE  RETURN.INSTRUCTIONS'------------  PRINT CHR$(147);  PRINT "…NSTRUCTIONS (PAGE 1 OF 2)"  PRINT "============"  PRINT "‘HE DINOSAURS ARE HUNGRY..."  PRINT  PRINT "...GO AND FIND THEM THE FOOD THAT THEY LIKE!"  PRINT  PRINT "◊HEN YOU GIVE THEM ALL THE RIGHT FOOD, THEY WILL REWARD YOU WITH A "  PRINT "NEW RETRO COMPUTER!"  PRINT  PRINT "...BUT BEWARE OF DIRTY OLD œNION √AKE..."  PRINT  PRINT "...HE IS ANGRY DUE TO SOMEBODY STEALING HIS FAVOURITE RETRO COMPUTER..."  PRINT  PRINT "ÕAYBE YOU CAN APPEASE HIS ANGER BY RETURNING IT TO HIM..."  GOSUB PRESSØAØKEY    PRINT CHR$(147);  PRINT "…NSTRUCTIONS (PAGE 2 OF 2)"  PRINT "============"  PRINT "‘HIS IS A SIMPLE TEXT ADVENTURE GAME ACCOMPANIED BY VECTOR ART DRAWN "  PRINT "(SLOWLY) VIA ¬¡”…√ 65 :)"  PRINT  PRINT "¡S ¬¡”…√ 65 DIDN'T COME WITH A ROUTINE TO DRAW FILLED IRREGULAR POLYGONS,"  PRINT "… HAD TO WRITE MY OWN (IN ¬¡”…√!), THAT MADE THINGS EVEN SLOWER :)"  PRINT  PRINT "¡RTWORK WILL BE CACHED AFTER 1ST DRAW ATTEMPT COMPLETES."  PRINT  PRINT "‘YPE SIMPLE ÷≈“¬ Œœ’Œ STRINGS TO INTERACT WITH THE GAME."  PRINT "  - ≈.G. ‘¡À≈ Õ≈«¡65"  PRINT  PRINT "ŸOU CAN ABBREVIATE ANY WORD TO THE FIRST 3 LETTERS."  PRINT "  - ≈.G. ‘¡À Õ≈«"  PRINT  PRINT "Œœ‘≈: √URRENT Õ≈«¡65 CORE HAS PROBLEMS IN 640X400 16 COLOUR MODE"  PRINT "- –ERFORMS BETTER IN ÿEMU RIGHT NOW"  PRINT "- “UN XEMU WITH '-FASTCLOCK 200' TO SPEED THINGS UP!"  GOSUB PRESSØAØKEY  PRINT CHR$(147);  PRINT "«AME ÷OCABULARY"  PRINT "---------------"  PRINT "- Œ, ”, ≈, ◊   (TO GO ŒORTH, ”OUTH, ≈AST, ◊EST)"  PRINT "- Ã/ÃœœÀ"  PRINT "- …/…Œ÷≈Œ‘œ“Ÿ"  PRINT "- «œ <PLACE>"  PRINT "- ‘¡À≈ <OBJECT>"  PRINT "- ’”≈ <OBJECT>"  PRINT "- «…÷≈ <OBJECT>"  PRINT "- »…‘ <OBJECT>"  PRINT "-  œ…Œ <OBJECT>"  PRINT "- —’…‘/≈ÿ…‘"  GOSUB PRESSØAØKEY  RETURN.CREDITS'-------  PRINT CHR$(147);  PRINT "√REDITS"  PRINT "======="  PRINT "√ODING AND ÕUSIC SEQUENCING BY «URCE …SIKYILDIZ"  PRINT "ƒINO ¡RTISTRY BY ¡YCA …SIKYILDIZ"  PRINT "- ŸOU'RE WELCOME TO DONATE TO THE ARTIST TO ENCOURAGE HER TO CONTRIBUTE MORE"  PRINT "  OF HER ARTWORK TO Õ≈«¡65 GAMES!"  PRINT "- ◊ELCOME TO DONATE A FEW DOLLARS OVER PAYPAL TO:"  PRINT "  –AY–AL USERNAME: INFO@WOMBATISTAN.COM"  PRINT  PRINT "”ONG COVER CREDITS"  PRINT "------------------"  PRINT "¡USTRALIA - ";CHR$(34);"”KIPPY THE ¬USH ÀANGAROO";CHR$(34);    PRINT " - ≈RIC  UPP"  PRINT "«ERMANY - ";CHR$(34);"99 ÃUFTBALLONS";CHR$(34);" - Œ≈Œ¡"  PRINT "‘HAILAND - ";CHR$(34);"ÀHAEK ¬ORATET ”AWNG √HAN";CHR$(34);    PRINT " - ’NKNOWN"  ' YOUTU.BE/»ÃQL⁄2J«BƒG  PRINT "‘URKEY - ";CHR$(34);"»ATCAM √IKMIS «UL ƒALINA";CHR$(34);    PRINT " - ’NKNOWN"  PRINT "÷IETNAM - ";CHR$(34);"‘RONG √OM (“ICE ƒRUM SONG)";CHR$(34);    PRINT " - ’NKNOWN"  GOSUB PRESSØAØKEY  PRINT CHR$(147);  PRINT "‘HANKS TO ÕR⁄AADII"  PRINT "------------------"  PRINT "∆INALLY, A WORD OF THANKS TO ÕR⁄AADII FOR HIS AWESOME YOUTUBE VIDEOS:"  PRINT "- HTTPS://TINYURL.COM/MRZAADII-PLAYLIST"  PRINT  PRINT "‘HE INSPIRATION FOR THIS GAME CAME FROM HIS '≈SCAPE FROM œNION √AKE' GAME:"  PRINT "- HTTPS://YOUTU.BE/‘V∆ÿ√ØQUUƒO"  PRINT  PRINT "»IS LAST-RELEASED VERSION OF THE GAME NO LONGER WORKS WITH LATEST Õ≈«¡65 “œÕ:"  PRINT "- HTTPS://TINYURL.COM/EFOC-ORIG"  PRINT  PRINT "…'VE MADE SOME REPAIRS/ENHANCEMENTS SO THAT IT RUNS ON LATEST Õ≈«¡65 “œÕ HERE:"  PRINT "- HTTPS://TINYURL.COM/EFOC-NEW"  GOSUB PRESSØAØKEY  RETURN.LOADØERROR'----------  BORDER 2  LOADØSTATE% = -4  PRINT "ERROR LOADING FILE..."  STOP  RETURN.FINDØYMINØYMAX'--------------  YMIN% = POLYØY%(0)  YMAX% = POLYØY%(0)  FOR IDX% = 0 TO POLYØIDX%-1    IF POLYØY%(IDX%) < YMIN% THEN YMIN% = POLYØY%(IDX%)    IF POLYØY%(IDX%) > YMAX% THEN YMAX% = POLYØY%(IDX%)  NEXT IDX%  RETURN .ISØYØINØLINEØYRANGE'-------------------  RET% = 0: REV% = 0  Y0% = POLYØY%(IDX%-1)  Y1% = POLYØY%(IDX%)  IF Y0% > Y1% THEN TMP%=Y0%:Y0% = Y1%:Y1% = TMP%:REV%=1  IF Y0% <= Y% AND Y% < Y1% THEN RET% = 1  RETURN.CHECKØLINEØINTERSECT'--------------------  GOSUB ISØYØINØLINEØYRANGE  IF RET% = 0 THEN RETURN  X0% = POLYØX%(IDX%-1)  X1% = POLYØX%(IDX%)  IF REV%=1 THEN TMP%=X0%:X0% = X1%:X1% = TMP%  IF X0% = X1% THEN X% =X0%:RET% = 1:RETURN  M = (Y1%-Y0%) / (X1% - X0%)  C = Y0% - M * X0%    X% = (Y% - C) / M  RET% = 1  RETURN.FINDØINTERSECTS'---------------  PIDX% = 0  ' CHECK LAST-POINT TO FIRST  POLYØX%(POLYØIDX%) = POLYØX%(0)  POLYØY%(POLYØIDX%) = POLYØY%(0)  FOR IDX% = 1 TO POLYØIDX%    GOSUB CHECKØLINEØINTERSECT    IF RET% = 1 THEN PX%(PIDX%)=X% : PIDX% = PIDX% + 1  NEXT IDX%  RETURN.SORTØINTERSECTS'---------------  ' BUBBLE SORT ALGORITHM FROM: GEEKSFORGEEKS.ORG/BUBBLE-SORT  #IFDEF ƒ≈¬’«Ø”œ“‘  GOSUB CLEARØMENU  CHAR 0,0,1,1,2,STR$(PIDX%-1)  FOR I%=0 TO PIDX%-1    CHAR 4+I%*4,0,1,1,2,STR$(PX%(I%))  NEXT I%#ENDIF  FOR I% = 0 TO PIDX%-2    SWAPPED% = 0    FOR J% = 0 TO PIDX%-I%-2      IF PX%(J%) > PX%(J%+1) THEN BEGIN        TMP%=PX%(J%)        PX%(J%) = PX%(J%+1)        PX%(J%+1) = TMP%        SWAPPED% = 1      BEND    NEXT J%    IF SWAPPED% = 0 THEN I% = PIDX%  ' EXIT EARLY  NEXT I%#IFDEF ƒ≈¬’«Ø”œ“‘  FOR I%=0 TO PIDX%-1    CHAR 4+I%*4,10,1,1,2,STR$(PX%(I%))  NEXT I%  GETKEY A$#ENDIF  RETURN.DRAWØHORIZONTALØINTERSECTS'--------------------------  GOSUB FINDØINTERSECTS  GOSUB SORTØINTERSECTS  FOR IDX%=0 TO PIDX%-1 STEP 2    LINE PX%(IDX%),Y%,PX%(IDX%+1),Y%  NEXT IDX%  RETURN.FILLØPOLY'---------  GOSUB FINDØYMINØYMAX  FOR Y%=YMIN% TO YMAX%    GOSUB DRAWØHORIZONTALØINTERSECTS  NEXT Y%  RETURN.CHECKØVECØHEADER'----------------  RET% = 0  IF K<>ASC("V") THEN RETURN  GET#2, K:PRINT K;  IF K<>ASC("E") THEN RETURN  GET#2, K:PRINT K;  IF K<>ASC("C") THEN RETURN  RET% = 1  VECØSIZE% = 3  LOADØSTATE%=-1  RETURN.LOADØFROMØCACHE'---------------  IF HASØATTICØRAM% THEN BEGIN    'Z = $8000000 + $20000*CURRENTØROOM%    'FOR K = 0 TO 7    'OFFS = K * $4000    'EDMA 0, $3E80, Z+OFFS, $40000+OFFS    'NEXT K    EDMA 0, 0, $8000000 + $20000*CURRENTØROOM%, $40000    EDMA 0, 0, $8000000 + $20000*CURRENTØROOM% + $10000, $50000  BEND  'PALETTE RESTORE  RETURN.LOAD'----  ' FOR NOW, JUST LOAD FROM A SINGLE HARD-CODED FILE  LOADØSTATE% = -4  DOPEN #2,(ROOMSØVART$(CURRENTØROOM%)),R,U8  DO    GET#2, K:PRINT "RD=";K;    IF ST THEN EXIT    IF LOADØSTATE% = -4 THEN BEGIN      PRINT "CHECKØVEC ";      GOSUB CHECKØVECØHEADER      IF RET% = 0 THEN GOSUB LOADØERROR:EXIT:ELSE GOTO NXTØLP    BEND    IF LOADØSTATE% = -1 THEN BEGIN      PRINT "NEWØCMD ";      FILLØSTATE% = (K AND 64)/64      K = K AND 63      LOADØSTATE% = K    BEND    IF LOADØSTATE% = √œÃœ’“ THEN BEGIN      PRINT "COLOUR ";      GET#2,K:PRINT K;      PEN 0, K      VECØDATA%(VECØSIZE%) = √œÃœ’“      VECØSIZE% = VECØSIZE% +1      VECØDATA%(VECØSIZE%) = K      VECØSIZE% = VECØSIZE% +1      LASTØCOLOUR% = K      SELECTEDØCOLOUR% = K      LOADØSTATE% = -1      GOTO NXTØLP    BEND    IF LOADØSTATE% = Ã…Œ≈ THEN BEGIN      PRINT "LINE ";      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      LX0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      LY0% = M0% + (M1% << 8) + OFFSET%:IF LY0%<0 THEN BEGIN:LY0%=0:BEND      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      MX% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      MY% = M0% + (M1% << 8) + OFFSET%:IF MY%<0 THEN BEGIN:MY%=0:BEND      LINE LX0%, LY0%, MX%, MY%      LOADØSTATE% = -1      GOTO NXTØLP    BEND    IF LOADØSTATE% = √…“√Ã≈ THEN BEGIN      PRINT "CIRCLE ";      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      CX0% = M0% + (M1% << 8)      GET#2,M0% : M0% = (M0% AND 255)      GET#2,M1% : M1% = (M1% AND 255)      CY0% = M0% + (M1% << 8) + OFFSET%:IF CY0%<0 THEN BEGIN:CY0%=0:BEND      GET#2,M0% : M0% = (M0% AND 255)      GET#2,M1% : M1% = (M1% AND 255)      RADIUS% = M0% + (M1% << 8)      CIRCLE CX0%, CY0%, RADIUS%, FILLØSTATE%      LOADØSTATE% = -1      GOTO NXTØLP    BEND    IF LOADØSTATE% = ≈ÃÃ…–”≈ THEN BEGIN      PRINT "ELLIPSE ";      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      EX0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      EY0% = M0% + (M1% << 8) + OFFSET%:IF EY0%<0 THEN BEGIN:EY0%=0:BEND      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      XRADIUS% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      YRADIUS% = M0% + (M1% << 8)      ELLIPSE EX0%, EY0%, XRADIUS%, YRADIUS%, FILLØSTATE%      LOADØSTATE% = -1      GOTO NXTØLP    BEND    IF LOADØSTATE% = ¬œÿ THEN BEGIN      PRINT "BOX ";      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      BX0% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      BY0% = M0% + (M1% << 8) + OFFSET% : IF BY0%<0 THEN BEGIN:BY0%=0:BEND      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      MX% = M0% + (M1% << 8)      GET#2,M0% : M0% = M0% AND 255      GET#2,M1% : M1% = M1% AND 255      MY% = M0% + (M1% << 8) + OFFSET% : IF MY%<0 THEN BEGIN:MY%=0:BEND      BOX BX0%, BY0%, MX%, MY%, FILLØSTATE%      LOADØSTATE% = -1      GOTO NXTØLP    BEND    IF LOADØSTATE% = –œÃŸ THEN BEGIN      PRINT "POLY ";      GET#2,K:K = K AND 255      POLYØIDX% = K      FOR K = 0 TO POLYØIDX%-1        GET#2,M0% : M0% = M0% AND 255        GET#2,M1% : M1% = M1% AND 255        POLYØX%(K) = M0% + (M1% << 8)        GET#2,M0% : M0% = M0% AND 255        GET#2,M1% : M1% = M1% AND 255        POLYØY%(K) = M0% + (M1% << 8) + OFFSET%        IF POLYØY%(K)<0 THEN BEGIN:POLYØY%(K)=0:BEND        IF (K>0) THEN LINE POLYØX%(K-1), POLYØY%(K-1), POLYØX%(K), POLYØY%(K)      NEXT K      LINE POLYØX%(POLYØIDX%-1),POLYØY%(POLYØIDX%-1),POLYØX%(0),POLYØY%(0)      IF FILLØSTATE% = 1 THEN GOSUB FILLØPOLY      LOADØSTATE% = -1      GOTO NXTØLP    BEND.NXTØLP  LOOP  DCLOSE #2  IF HASØATTICØRAM% THEN BEGIN    EDMA 0, 0, $40000, $8000000 + $20000*CURRENTØROOM%    EDMA 0, 0, $50000, $8000000 + $20000*CURRENTØROOM% + $10000    CACHED%(CURRENTØROOM%) = 1  BEND  RETURN